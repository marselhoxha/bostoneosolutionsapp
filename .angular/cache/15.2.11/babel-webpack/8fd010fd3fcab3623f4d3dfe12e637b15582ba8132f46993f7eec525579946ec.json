{"ast":null,"code":"import { BehaviorSubject, map, startWith, catchError, of } from 'rxjs';\nimport { DataState } from 'src/app/enum/datastate.enum';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/service/customer.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"../navbar/navbar.component\";\nfunction NewinvoiceComponent_ng_container_0_ng_container_1_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 37);\n    i0.ɵɵtext(1);\n    i0.ɵɵelement(2, \"button\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const state_r1 = i0.ɵɵnextContext(2).ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", state_r1.error, \" \");\n  }\n}\nfunction NewinvoiceComponent_ng_container_0_ng_container_1_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtext(1);\n    i0.ɵɵelement(2, \"button\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const state_r1 = i0.ɵɵnextContext(2).ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", state_r1.appData.message, \" \");\n  }\n}\nfunction NewinvoiceComponent_ng_container_0_ng_container_1_option_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 40);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const customer_r12 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", customer_r12.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", customer_r12.name, \" \");\n  }\n}\nfunction NewinvoiceComponent_ng_container_0_ng_container_1_span_62_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 41);\n  }\n}\nfunction NewinvoiceComponent_ng_container_0_ng_container_1_span_64_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Saving...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction NewinvoiceComponent_ng_container_0_ng_container_1_span_66_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Save Invoice\");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function () {\n  return [\"/\"];\n};\nconst _c1 = function () {\n  return [\"/invoices\"];\n};\nfunction NewinvoiceComponent_ng_container_0_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"app-navbar\", 3);\n    i0.ɵɵelementStart(2, \"section\")(3, \"div\", 4)(4, \"nav\", 5)(5, \"ol\", 6)(6, \"li\", 7)(7, \"a\", 8);\n    i0.ɵɵtext(8, \"Home\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"li\", 7)(10, \"a\", 8);\n    i0.ɵɵtext(11, \"Invoices\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"li\", 9);\n    i0.ɵɵtext(13, \"New\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(14, \"div\", 10)(15, \"div\", 11)(16, \"div\", 12)(17, \"div\", 13)(18, \"div\", 14)(19, \"h2\");\n    i0.ɵɵelement(20, \"i\", 15);\n    i0.ɵɵtext(21, \" New Invoice \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(22, NewinvoiceComponent_ng_container_0_ng_container_1_div_22_Template, 3, 1, \"div\", 16);\n    i0.ɵɵtemplate(23, NewinvoiceComponent_ng_container_0_ng_container_1_div_23_Template, 3, 1, \"div\", 17);\n    i0.ɵɵelementStart(24, \"form\", 18, 19);\n    i0.ɵɵlistener(\"ngSubmit\", function NewinvoiceComponent_ng_container_0_ng_container_1_Template_form_ngSubmit_24_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const _r5 = i0.ɵɵreference(25);\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.newInvoice(_r5));\n    });\n    i0.ɵɵelementStart(26, \"div\", 20)(27, \"div\", 21)(28, \"div\", 22)(29, \"label\");\n    i0.ɵɵtext(30, \"Services\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(31, \"input\", 23);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(32, \"div\", 24)(33, \"label\");\n    i0.ɵɵtext(34, \"Customer\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(35, \"select\", 25);\n    i0.ɵɵtemplate(36, NewinvoiceComponent_ng_container_0_ng_container_1_option_36_Template, 2, 2, \"option\", 26);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(37, \"div\", 24)(38, \"div\", 22)(39, \"label\");\n    i0.ɵɵtext(40, \"Total\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(41, \"input\", 27);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(42, \"div\", 24)(43, \"div\", 22)(44, \"label\");\n    i0.ɵɵtext(45, \"Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(46, \"input\", 28);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(47, \"div\", 24)(48, \"label\");\n    i0.ɵɵtext(49, \"Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(50, \"select\", 29)(51, \"option\", 30);\n    i0.ɵɵtext(52, \"PENDING\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(53, \"option\", 31);\n    i0.ɵɵtext(54, \"PAID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(55, \"option\", 32);\n    i0.ɵɵtext(56, \"CANCELED\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(57, \"option\", 33);\n    i0.ɵɵtext(58, \"OVERDUE\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(59, \"div\")(60, \"button\", 34);\n    i0.ɵɵpipe(61, \"async\");\n    i0.ɵɵtemplate(62, NewinvoiceComponent_ng_container_0_ng_container_1_span_62_Template, 1, 0, \"span\", 35);\n    i0.ɵɵpipe(63, \"async\");\n    i0.ɵɵtemplate(64, NewinvoiceComponent_ng_container_0_ng_container_1_span_64_Template, 2, 0, \"span\", 36);\n    i0.ɵɵpipe(65, \"async\");\n    i0.ɵɵtemplate(66, NewinvoiceComponent_ng_container_0_ng_container_1_span_66_Template, 2, 0, \"span\", 36);\n    i0.ɵɵpipe(67, \"async\");\n    i0.ɵɵelementEnd()()()()()()()()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const _r5 = i0.ɵɵreference(25);\n    const state_r1 = i0.ɵɵnextContext().ngIf;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"user\", state_r1 == null ? null : state_r1.appData == null ? null : state_r1.appData.data == null ? null : state_r1.appData.data.user);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(18, _c0));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(19, _c1));\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngIf\", state_r1.error);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", state_r1.appData.message);\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngForOf\", state_r1 == null ? null : state_r1.appData == null ? null : state_r1.appData.data == null ? null : state_r1.appData.data.customers);\n    i0.ɵɵadvance(24);\n    i0.ɵɵproperty(\"disabled\", state_r1.dataState === ctx_r2.DataState.LOADING || _r5.invalid || _r5.pristine || i0.ɵɵpipeBind1(61, 10, ctx_r2.isLaoding$));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(63, 12, ctx_r2.isLaoding$));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(65, 14, ctx_r2.isLaoding$));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(67, 16, ctx_r2.isLaoding$));\n  }\n}\nfunction NewinvoiceComponent_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0, 1);\n    i0.ɵɵtemplate(1, NewinvoiceComponent_ng_container_0_ng_container_1_Template, 68, 20, \"ng-container\", 2);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const state_r1 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngSwitch\", state_r1.dataState);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", ctx_r0.DataState.LOADED);\n  }\n}\nexport class NewinvoiceComponent {\n  constructor(customerService) {\n    this.customerService = customerService;\n    this.dataSubject = new BehaviorSubject(null);\n    this.isLoadingSubject = new BehaviorSubject(false);\n    this.isLoading$ = this.isLoadingSubject.asObservable();\n    this.DataState = DataState;\n  }\n  ngOnInit() {\n    this.newInvoiceState$ = this.customerService.newInvoice$().pipe(map(response => {\n      console.log(response);\n      this.dataSubject.next(response);\n      return {\n        dataState: DataState.LOADED,\n        appData: response\n      };\n    }), startWith({\n      dataState: DataState.LOADING\n    }), catchError(error => {\n      return of({\n        dataState: DataState.ERROR,\n        error\n      });\n    }));\n  }\n  newInvoice(newInvoiceForm) {\n    this.dataSubject.next(Object.assign(Object.assign({}, this.dataSubject.value), {\n      message: null\n    }));\n    this.isLoadingSubject.next(true);\n    this.newInvoiceState$ = this.customerService.createInvoice$(newInvoiceForm.value.customerId, newInvoiceForm.value).pipe(map(response => {\n      console.log(response);\n      newInvoiceForm.reset({\n        status: 'PENDING'\n      });\n      this.isLoadingSubject.next(false);\n      this.dataSubject.next(response);\n      return {\n        dataState: DataState.LOADED,\n        appData: this.dataSubject.value\n      };\n    }), startWith({\n      dataState: DataState.LOADED,\n      appData: this.dataSubject.value\n    }), catchError(error => {\n      this.isLoadingSubject.next(false);\n      return of({\n        dataState: DataState.LOADED,\n        error\n      });\n    }));\n  }\n}\nNewinvoiceComponent.ɵfac = function NewinvoiceComponent_Factory(t) {\n  return new (t || NewinvoiceComponent)(i0.ɵɵdirectiveInject(i1.CustomerService));\n};\nNewinvoiceComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: NewinvoiceComponent,\n  selectors: [[\"app-newinvoice\"]],\n  decls: 2,\n  vars: 3,\n  consts: [[3, \"ngSwitch\", 4, \"ngIf\"], [3, \"ngSwitch\"], [4, \"ngSwitchCase\"], [3, \"user\"], [1, \"container\"], [\"aria-label\", \"breadcrumb\", 2, \"margin-top\", \"8px\"], [1, \"breadcrumb\"], [1, \"breadcrumb-item\"], [3, \"routerLink\"], [\"aria-current\", \"page\", 1, \"breadcrumb-item\", \"active\"], [1, \"row\", \"justify-content-center\"], [1, \"col-md-12\"], [1, \"card\"], [1, \"card-body\"], [1, \"text-center\"], [1, \"bi\", \"bi-receipt\", 2, \"margin-right\", \"5px\"], [\"class\", \"alert alert-danger bg-danger text-light border-0 alert-dismissible fade show\", \"role\", \"alert\", 4, \"ngIf\"], [\"class\", \"alert alert-success bg-success text-light border-0 alert-dismissible fade show\", \"role\", \"alert\", 4, \"ngIf\"], [3, \"ngSubmit\"], [\"invoiceForm\", \"ngForm\"], [1, \"row\"], [1, \"col-md-12\", 2, \"margin-bottom\", \"15px\"], [1, \"form-group\"], [\"type\", \"text\", \"ngModel\", \"\", \"name\", \"services\", \"required\", \"\", 1, \"form-control\"], [1, \"col-md-6\", 2, \"margin-bottom\", \"15px\"], [\"name\", \"customerId\", \"required\", \"\", 1, \"form-control\", \"select-cl\", 3, \"ngModel\"], [\"class\", \"select-cl\", 3, \"ngValue\", \"selected\", \"disabled\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"total\", \"ngModel\", \"\", \"name\", \"total\", \"required\", \"\", 1, \"form-control\"], [\"type\", \"date\", \"ngModel\", \"\", \"name\", \"date\", \"required\", \"\", 1, \"form-control\"], [\"name\", \"status\", \"ngModel\", \"PENDING\", \"required\", \"\", 1, \"form-control\"], [\"value\", \"PENDING\"], [\"value\", \"PAID\"], [\"value\", \"CANCELED\"], [\"value\", \"OVERDUE\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"mt-5\", 3, \"disabled\"], [\"class\", \"spinner-border spinner-border-sm\", \"role\", \"status\", \"aria-hidden\", \"true\", \"style\", \"margin-right: 5px;\", 4, \"ngIf\"], [4, \"ngIf\"], [\"role\", \"alert\", 1, \"alert\", \"alert-danger\", \"bg-danger\", \"text-light\", \"border-0\", \"alert-dismissible\", \"fade\", \"show\"], [\"type\", \"button\", \"data-bs-dismiss\", \"alert\", \"aria-label\", \"Close\", 1, \"btn-close\", \"btn-close-white\"], [\"role\", \"alert\", 1, \"alert\", \"alert-success\", \"bg-success\", \"text-light\", \"border-0\", \"alert-dismissible\", \"fade\", \"show\"], [1, \"select-cl\", 3, \"ngValue\", \"selected\", \"disabled\"], [\"role\", \"status\", \"aria-hidden\", \"true\", 1, \"spinner-border\", \"spinner-border-sm\", 2, \"margin-right\", \"5px\"]],\n  template: function NewinvoiceComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, NewinvoiceComponent_ng_container_0_Template, 2, 2, \"ng-container\", 0);\n      i0.ɵɵpipe(1, \"async\");\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(1, 1, ctx.newInvoiceState$));\n    }\n  },\n  dependencies: [i2.NgForOf, i2.NgIf, i2.NgSwitch, i2.NgSwitchCase, i3.RouterLink, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm, i5.NavbarComponent, i2.AsyncPipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["BehaviorSubject","map","startWith","catchError","of","DataState","i0","NewinvoiceComponent","constructor","customerService","isLoadingSubject","asObservable","ngOnInit","newInvoiceState$","newInvoice$","pipe","response","console","log","dataSubject","next","dataState","LOADED","appData","LOADING","error","ERROR","newInvoice","newInvoiceForm","value","message","createInvoice$","customerId","reset","status","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/Users/marsel/bostoneo/bostoneosolutionsapp/src/app/component/newinvoice/newinvoice.component.ts","/Users/marsel/bostoneo/bostoneosolutionsapp/src/app/component/newinvoice/newinvoice.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { NgForm } from '@angular/forms';\nimport { Observable, BehaviorSubject, map, startWith, catchError, of } from 'rxjs';\nimport { DataState } from 'src/app/enum/datastate.enum';\nimport { CustomHttpResponse, Page } from 'src/app/interface/appstates';\nimport { Customer } from 'src/app/interface/customer';\nimport { State } from 'src/app/interface/state';\nimport { User } from 'src/app/interface/user';\nimport { CustomerService } from 'src/app/service/customer.service';\n\n@Component({\n  selector: 'app-newinvoice',\n  templateUrl: './newinvoice.component.html',\n  styleUrls: ['./newinvoice.component.css']\n})\nexport class NewinvoiceComponent implements OnInit {\n  newInvoiceState$: Observable<State<CustomHttpResponse<Customer[] & User>>>;\n  private dataSubject = new BehaviorSubject<CustomHttpResponse<Customer[] & User>>(null);\n  private isLoadingSubject = new BehaviorSubject<boolean>(false);\n  isLoading$ = this.isLoadingSubject.asObservable();\n  readonly DataState = DataState;\n\n  constructor(private customerService: CustomerService) { }\n\n  ngOnInit(): void {\n    this.newInvoiceState$ = this.customerService.newInvoice$()\n      .pipe(\n        map(response => {\n          console.log(response);\n          this.dataSubject.next(response);\n          return { dataState: DataState.LOADED, appData: response };\n        }),\n        startWith({ dataState: DataState.LOADING }),\n        catchError((error: string) => {\n          return of({ dataState: DataState.ERROR, error })\n        })\n      )\n  }\n\n  newInvoice(newInvoiceForm: NgForm): void {\n    this.dataSubject.next({ ...this.dataSubject.value, message: null });\n    this.isLoadingSubject.next(true);\n    this.newInvoiceState$ = this.customerService.createInvoice$(newInvoiceForm.value.customerId, newInvoiceForm.value)\n      .pipe(\n        map(response => {\n          console.log(response);\n          newInvoiceForm.reset({ status: 'PENDING' });\n          this.isLoadingSubject.next(false);\n          this.dataSubject.next(response);\n          return { dataState: DataState.LOADED, appData: this.dataSubject.value };\n        }),\n        startWith({ dataState: DataState.LOADED, appData: this.dataSubject.value }),\n        catchError((error: string) => {\n          this.isLoadingSubject.next(false);\n          return of({ dataState: DataState.LOADED, error })\n        })\n      )\n  }\n\n}\n","<ng-container *ngIf=\"(newInvoiceState$ | async) as state\" [ngSwitch]=\"state.dataState\">\n    <ng-container *ngSwitchCase=\"DataState.LOADED\">\n        <app-navbar [user]=\"state?.appData?.data?.user\"></app-navbar>\n        <section>\n            <div class=\"container\">\n                <nav aria-label=\"breadcrumb\" style=\"margin-top: 8px;\">\n                    <ol class=\"breadcrumb\">\n                        <li class=\"breadcrumb-item\">\n                            <a [routerLink]=\"['/']\">Home</a>\n                        </li>\n                        <li class=\"breadcrumb-item\"> <a [routerLink]=\"['/invoices']\">Invoices</a> </li>\n                        <li class=\"breadcrumb-item active\" aria-current=\"page\">New</li>\n                    </ol>\n                </nav>\n                <div class=\"row justify-content-center\">\n                    <div class=\"col-md-12\">\n                        <div class=\"card\">\n                            <div class=\"card-body\">\n                                <div class=\"text-center\">\n                                    <h2><i style=\"margin-right: 5px;\" class=\"bi bi-receipt\"></i> New Invoice\n                                    </h2>\n                                </div>\n                                <div *ngIf=\"state.error\"\n                                    class=\"alert alert-danger bg-danger text-light border-0 alert-dismissible fade show\"\n                                    role=\"alert\">\n                                    {{ state.error }}\n                                    <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"alert\"\n                                        aria-label=\"Close\"></button>\n                                </div>\n                                <div *ngIf=\"state.appData.message\"\n                                    class=\"alert alert-success bg-success text-light border-0 alert-dismissible fade show\"\n                                    role=\"alert\">\n                                    {{ state.appData.message }}\n                                    <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"alert\"\n                                        aria-label=\"Close\"></button>\n                                </div>\n\n                                <form #invoiceForm=\"ngForm\" (ngSubmit)=\"newInvoice(invoiceForm)\">\n                                    <div class=\"row\">\n                                        <div class=\"col-md-12\" style=\"margin-bottom: 15px;\">\n                                            <div class=\"form-group\">\n                                                <label>Services</label>\n                                                <input type=\"text\" ngModel name=\"services\" class=\"form-control\" required>\n                                            </div>\n                                        </div>\n                                        <div class=\"col-md-6\" style=\"margin-bottom: 15px;\">\n                                            <label>Customer</label>\n                                            <select [ngModel]=\"\" name=\"customerId\" class=\"form-control select-cl\" required>\n                                                <option *ngFor=\"let customer of state?.appData?.data?.customers\"\n                                                   [ngValue]=\"customer.id\"\n                                                   [selected]=\"\"\n                                                   [disabled]=\"\"\n                                                   class=\"select-cl\">{{ customer.name }}\n                                                </option>\n                                            </select>\n                                        </div>\n                                        <div class=\"col-md-6\" style=\"margin-bottom: 15px;\">\n                                            <div class=\"form-group\">\n                                                <label>Total</label>\n                                                <input type=\"total\" ngModel name=\"total\" class=\"form-control\" required>\n                                            </div>\n                                        </div>\n                                        <div class=\"col-md-6\" style=\"margin-bottom: 15px;\">\n                                            <div class=\"form-group\">\n                                                <label>Date</label>\n                                                <input type=\"date\" ngModel name=\"date\" class=\"form-control\" required>\n                                            </div>\n                                        </div>\n                                        <div class=\"col-md-6\" style=\"margin-bottom: 15px;\">\n                                            <label>Status</label>\n                                            <select name=\"status\" ngModel=\"PENDING\" class=\"form-control\" required>\n                                                <option value=\"PENDING\">PENDING</option>\n                                                <option value=\"PAID\">PAID</option>\n                                                <option value=\"CANCELED\">CANCELED</option>\n                                                <option value=\"OVERDUE\">OVERDUE</option>\n                                            </select>\n                                        </div>\n                                    </div>\n                                    <div>\n                                        <button [disabled]=\"state.dataState === DataState.LOADING || invoiceForm.invalid || invoiceForm.pristine|| (isLaoding$ | async)\"\n                                         type=\"submit\" class=\"btn btn-primary mt-5\">\n                                            <span *ngIf=\"isLaoding$ | async\" class=\"spinner-border spinner-border-sm\"\n                                                role=\"status\" aria-hidden=\"true\" style=\"margin-right: 5px;\"></span>\n                                            <span *ngIf=\"isLaoding$ | async\">Saving...</span>\n                                            <span *ngIf=\"!(isLaoding$ | async)\">Save Invoice</span>\n                                        </button>\n                                    </div>\n                                </form>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </section>\n    </ng-container>\n</ng-container>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}